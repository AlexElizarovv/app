<match fluent.**>
	# this tells fluentd to not output its log on stdout
	@type null
</match>

<source>
  	@type tcp
  	tag mediawiki
  	port 9999
  	<parse>
		@type json
		time_format %Y-%m-%dT%H:%M:%S.%N%z
		time_key @timestamp
	</parse>
</source>

<match *>
	@type copy
	<store>
		@type stdout
	</store>
	<store>
		@type elasticsearch
		host logs-prod.es.service.sjc.consul
		logstash_format true
		logstash_prefix logstash-dev-mediawiki
		<buffer>
			flush_thread_count 2
			flush_interval 5s
			chunk_limit_size 2M
			queue_limit_length 32
			retry_max_interval 30
			retry_forever true
		</buffer>
	</store>
</match>
